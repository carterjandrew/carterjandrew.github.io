import{j as s}from"./index-ByR0HOzQ.js";function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",...e.components};return s.jsxs(s.Fragment,{children:[s.jsx(n.h1,{id:"what-does-that-even-mean",children:"What does that even mean"}),`
`,s.jsx(n.p,{children:"Okay, to start, we should have a context of what AWS IAM roles are. An IAM role gives a user access to AWS resources in line with the policy attached to the role. This means we can use the AWS SDKs or the CLI to interact with different resources. Unlike IAM users, IAM roles are not tied to a specific user or group, and they are temporary, meaning the credentials given to a client are only set to work for a limited time (usually an hour) before they expire."}),`
`,s.jsx(n.p,{children:"So, why exactly would you want to use dynamic roles like this? Well, there are a couple of compelling reasons:"}),`
`,s.jsxs(n.ol,{children:[`
`,s.jsxs(n.li,{children:[`
`,s.jsxs(n.p,{children:[s.jsx(n.strong,{children:"Temporary Access"}),": You want users to access a resource without needing a permanent IAM account. For instance, a guest might need access to a shopping cart to view items or checkout, but you don’t want to create and manage an IAM user account for this temporary access."]}),`
`]}),`
`,s.jsxs(n.li,{children:[`
`,s.jsxs(n.p,{children:[s.jsx(n.strong,{children:"Enhanced Security"}),": Dynamic roles can enhance security by limiting the duration and scope of access. For example, you can issue temporary credentials to a user for a specific task, and once the task is completed, the credentials expire. This minimizes the risk of long-term exposure."]}),`
`]}),`
`,s.jsxs(n.li,{children:[`
`,s.jsxs(n.p,{children:[s.jsx(n.strong,{children:"Cross-Account Access"}),": If you need to grant access to resources in a different AWS account, you can use IAM roles. For example, an application in Account A might need to access resources in Account B. You can create a role in Account B that allows Account A to assume it, enabling cross-account resource access."]}),`
`]}),`
`,s.jsxs(n.li,{children:[`
`,s.jsxs(n.p,{children:[s.jsx(n.strong,{children:"Federated Access"}),": You can use IAM roles to provide access to AWS resources for users who are authenticated by external identity providers (e.g., Google, Facebook, or corporate SSO). This is useful for integrating AWS services with existing authentication systems."]}),`
`]}),`
`,s.jsxs(n.li,{children:[`
`,s.jsxs(n.p,{children:[s.jsx(n.strong,{children:"On-the-fly Content Access"}),": You can define dynamic resource access for each and every user from any federated source. This makes it easy to provide a webapp with user granular details."]}),`
`]}),`
`]}),`
`,s.jsx(n.h2,{id:"how-to-create-and-use-dynamic-iam-roles-with-sts-using-aws-sam-and-lambda",children:"How to Create and Use Dynamic IAM Roles with STS using AWS SAM and Lambda"}),`
`,s.jsx(n.p,{children:"AWS Security Token Service (STS) is used to create temporary security credentials. Here’s a quick overview of how you can use STS in a Lambda function to create dynamic IAM roles for any user:"}),`
`,s.jsxs(n.h3,{id:"1-define-an-iam-role",children:["1. ",s.jsx(n.strong,{children:"Define an IAM Role"})]}),`
`,s.jsx(n.p,{children:"First, create an IAM role with a policy that allows the resource to assume tempoaray roles from a given role defition"}),`
`,s.jsx(n.pre,{className:"language-yaml",children:s.jsxs(n.code,{className:"language-yaml code-highlight",children:[s.jsxs(n.span,{className:"code-line",children:["  ",s.jsx(n.span,{className:"token key atrule",children:"WebApiRole"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["    ",s.jsx(n.span,{className:"token key atrule",children:"Type"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'AWS::IAM::Role'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["    ",s.jsx(n.span,{className:"token key atrule",children:"Properties"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["      ",s.jsx(n.span,{className:"token key atrule",children:"AssumeRolePolicyDocument"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["        ",s.jsx(n.span,{className:"token key atrule",children:"Version"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'2012-10-17'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["        ",s.jsx(n.span,{className:"token key atrule",children:"Statement"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["          ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token key atrule",children:"Effect"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'Allow'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["            ",s.jsx(n.span,{className:"token key atrule",children:"Principal"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["              ",s.jsx(n.span,{className:"token key atrule",children:"Service"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'lambda.amazonaws.com'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["              ",s.jsx(n.span,{className:"token key atrule",children:"AWS"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token tag",children:"!Sub"})," ",s.jsx(n.span,{className:"token string",children:"'arn:aws:iam::893462342304:user/example'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["            ",s.jsx(n.span,{className:"token key atrule",children:"Action"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'sts:AssumeRole'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["      ",s.jsx(n.span,{className:"token key atrule",children:"Policies"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["        ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token key atrule",children:"PolicyName"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'LambdaBasicExecution'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["          ",s.jsx(n.span,{className:"token key atrule",children:"PolicyDocument"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["            ",s.jsx(n.span,{className:"token key atrule",children:"Version"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'2012-10-17'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["            ",s.jsx(n.span,{className:"token key atrule",children:"Statement"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["              ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token key atrule",children:"Effect"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'Allow'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                ",s.jsx(n.span,{className:"token key atrule",children:"Action"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                  ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token string",children:"'logs:CreateLogGroup'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                  ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token string",children:"'logs:CreateLogStream'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                  ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token string",children:"'logs:PutLogEvents'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                ",s.jsx(n.span,{className:"token key atrule",children:"Resource"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'*'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["        ",s.jsx(n.span,{className:"token punctuation",children:"-"}),"  ",s.jsx(n.span,{className:"token key atrule",children:"PolicyName"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'S3CrudPolicy'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["           ",s.jsx(n.span,{className:"token key atrule",children:"PolicyDocument"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["             ",s.jsx(n.span,{className:"token key atrule",children:"Version"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'2012-10-17'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["             ",s.jsx(n.span,{className:"token key atrule",children:"Statement"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["               ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token key atrule",children:"Effect"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'Allow'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                 ",s.jsx(n.span,{className:"token key atrule",children:"Action"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                   ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token string",children:"'s3:GetObject'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                   ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token string",children:"'s3:PutObject'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                   ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token string",children:"'s3:DeleteObject'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                   ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token string",children:"'s3:ListBucket'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                   ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token string",children:"'s3:CopyObject'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                 ",s.jsx(n.span,{className:"token key atrule",children:"Resource"}),s.jsx(n.span,{className:"token punctuation",children:":"}),` 
`]}),s.jsxs(n.span,{className:"code-line",children:["                   ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token tag",children:"!Sub"})," ",s.jsx(n.span,{className:"token string",children:"'arn:aws:s3:::${EditBucket}'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                   ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token tag",children:"!Sub"})," ",s.jsx(n.span,{className:"token string",children:"'arn:aws:s3:::${EditBucket}/*'"}),`
`]}),s.jsx(n.span,{className:"code-line",children:`
`})]})}),`
`,s.jsxs(n.h3,{id:"2-create-an-second-role-with-general-access-to-your-resources",children:["2. ",s.jsx(n.strong,{children:"Create an second role with general access to your resources"})]}),`
`,s.jsx(n.pre,{className:"language-yaml",children:s.jsxs(n.code,{className:"language-yaml code-highlight",children:[s.jsxs(n.span,{className:"code-line",children:["  ",s.jsx(n.span,{className:"token key atrule",children:"TemporaryS3AccessRole"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["    ",s.jsx(n.span,{className:"token key atrule",children:"Type"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'AWS::IAM::Role'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["    ",s.jsx(n.span,{className:"token key atrule",children:"Properties"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["      ",s.jsx(n.span,{className:"token key atrule",children:"AssumeRolePolicyDocument"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["        ",s.jsx(n.span,{className:"token key atrule",children:"Version"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'2012-10-17'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["        ",s.jsx(n.span,{className:"token key atrule",children:"Statement"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["          ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token key atrule",children:"Effect"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'Allow'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["            ",s.jsx(n.span,{className:"token key atrule",children:"Principal"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["              ",s.jsx(n.span,{className:"token key atrule",children:"AWS"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'*'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["            ",s.jsx(n.span,{className:"token key atrule",children:"Action"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'sts:AssumeRole'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["      ",s.jsx(n.span,{className:"token key atrule",children:"Policies"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["        ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token key atrule",children:"PolicyName"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'S3AccessPolicy'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["          ",s.jsx(n.span,{className:"token key atrule",children:"PolicyDocument"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["            ",s.jsx(n.span,{className:"token key atrule",children:"Version"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'2012-10-17'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["            ",s.jsx(n.span,{className:"token key atrule",children:"Statement"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["              ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token key atrule",children:"Effect"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token string",children:"'Allow'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                ",s.jsx(n.span,{className:"token key atrule",children:"Action"}),s.jsx(n.span,{className:"token punctuation",children:":"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                  ",s.jsx(n.span,{className:"token punctuation",children:"-"})," ",s.jsx(n.span,{className:"token string",children:"'s3:GetObject'"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["                ",s.jsx(n.span,{className:"token key atrule",children:"Resource"}),s.jsx(n.span,{className:"token punctuation",children:":"})," ",s.jsx(n.span,{className:"token tag",children:"!Sub"})," ",s.jsx(n.span,{className:"token string",children:"'arn:aws:s3:::${EditBucket}/*'"}),`
`]})]})}),`
`,s.jsxs(n.h3,{id:"3-define-a-lambda-function-that-works-with-our-webapirole-to-assume-temporary-roles-in-sts-then-send-those-permissions-back-to-our-client",children:["3. ",s.jsxs(n.strong,{children:["Define a lambda function that works with our ",s.jsx(n.code,{children:"WebApiRole"})," to assume temporary roles in sts, then send those permissions back to our client"]})]}),`
`,s.jsx(n.p,{children:"Build a lambda function endpoint that handles the creation of a role using the AWS STS sdk"}),`
`,s.jsx(n.pre,{className:"language-ts",children:s.jsxs(n.code,{className:"language-ts code-highlight",children:[s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token keyword",children:"const"})," policy ",s.jsx(n.span,{className:"token operator",children:"="})," ",s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		Version",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token string",children:'"2012-10-17"'}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		Statement",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token punctuation",children:"["}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["			",s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["				Effect",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token string",children:'"Allow"'}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["				Action",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token string",children:'"s3:GetObject"'}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["				Resource",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsxs(n.span,{className:"token template-string",children:[s.jsx(n.span,{className:"token template-punctuation string",children:"`"}),s.jsx(n.span,{className:"token string",children:"arn:aws:s3:::"}),s.jsxs(n.span,{className:"token interpolation",children:[s.jsx(n.span,{className:"token interpolation-punctuation punctuation",children:"${"}),"requestConfig",s.jsx(n.span,{className:"token punctuation",children:"."}),"Bucket",s.jsx(n.span,{className:"token interpolation-punctuation punctuation",children:"}"})]}),s.jsx(n.span,{className:"token string",children:"/"}),s.jsxs(n.span,{className:"token interpolation",children:[s.jsx(n.span,{className:"token interpolation-punctuation punctuation",children:"${"}),s.jsx(n.span,{className:"token function",children:"getAppPrefix"}),s.jsx(n.span,{className:"token punctuation",children:"("}),"userId",s.jsx(n.span,{className:"token punctuation",children:","})," appName",s.jsx(n.span,{className:"token punctuation",children:")"}),s.jsx(n.span,{className:"token interpolation-punctuation punctuation",children:"}"})]}),s.jsx(n.span,{className:"token string",children:"/*"}),s.jsx(n.span,{className:"token template-punctuation string",children:"`"})]}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["			",s.jsx(n.span,{className:"token punctuation",children:"}"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		",s.jsx(n.span,{className:"token punctuation",children:"]"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token punctuation",children:"}"}),s.jsx(n.span,{className:"token punctuation",children:";"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token keyword",children:"const"})," getSessionTokenCommand ",s.jsx(n.span,{className:"token operator",children:"="})," ",s.jsx(n.span,{className:"token keyword",children:"new"})," ",s.jsx(n.span,{className:"token class-name",children:"AssumeRoleCommand"}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		RoleArn",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token constant",children:"ROLE_ARN"}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		RoleSessionName",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsxs(n.span,{className:"token template-string",children:[s.jsx(n.span,{className:"token template-punctuation string",children:"`"}),s.jsx(n.span,{className:"token string",children:"TempS3AccessRoleFor"}),s.jsxs(n.span,{className:"token interpolation",children:[s.jsx(n.span,{className:"token interpolation-punctuation punctuation",children:"${"}),"userId",s.jsx(n.span,{className:"token interpolation-punctuation punctuation",children:"}"})]}),s.jsx(n.span,{className:"token template-punctuation string",children:"`"})]}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		Policy",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token constant",children:"JSON"}),s.jsx(n.span,{className:"token punctuation",children:"."}),s.jsx(n.span,{className:"token function",children:"stringify"}),s.jsx(n.span,{className:"token punctuation",children:"("}),"policy",s.jsx(n.span,{className:"token punctuation",children:")"}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		DurationSeconds",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token number",children:"3600"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token punctuation",children:"}"}),s.jsx(n.span,{className:"token punctuation",children:")"}),s.jsx(n.span,{className:"token punctuation",children:";"}),`
`]}),s.jsx(n.span,{className:"code-line",children:`
`}),s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token keyword",children:"const"})," temporaryCredentials ",s.jsx(n.span,{className:"token operator",children:"="})," ",s.jsx(n.span,{className:"token keyword",children:"await"})," stsClient",s.jsx(n.span,{className:"token punctuation",children:"."}),s.jsx(n.span,{className:"token function",children:"send"}),s.jsx(n.span,{className:"token punctuation",children:"("}),"getSessionTokenCommand",s.jsx(n.span,{className:"token punctuation",children:")"}),s.jsx(n.span,{className:"token punctuation",children:";"}),`
`]}),s.jsx(n.span,{className:"code-line",children:`
`}),s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token keyword",children:"return"})," ",s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		statusCode",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token number",children:"200"}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		body",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token constant",children:"JSON"}),s.jsx(n.span,{className:"token punctuation",children:"."}),s.jsx(n.span,{className:"token function",children:"stringify"}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["			iamCredentials",s.jsx(n.span,{className:"token operator",children:":"})," temporaryCredentials",s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		",s.jsx(n.span,{className:"token punctuation",children:"}"}),s.jsx(n.span,{className:"token punctuation",children:")"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token punctuation",children:"}"}),`
`]}),s.jsx(n.span,{className:"code-line",children:`
`})]})}),`
`,s.jsxs(n.h3,{id:"4-utilize-role-in-client-to-access-a-resource",children:["4. ",s.jsx(n.strong,{children:"Utilize role in client to access a resource"})]}),`
`,s.jsx(n.p,{children:"Using a state in react we can keep track of the iam credentials we get back from our api"}),`
`,s.jsx(n.pre,{className:"language-ts",children:s.jsxs(n.code,{className:"language-ts code-highlight",children:[s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token function",children:"useEffect"}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token punctuation",children:")"})," ",s.jsx(n.span,{className:"token operator",children:"=>"})," ",s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		",s.jsx(n.span,{className:"token keyword",children:"if"})," ",s.jsx(n.span,{className:"token punctuation",children:"("}),"app",s.jsx(n.span,{className:"token punctuation",children:")"})," ",s.jsx(n.span,{className:"token function",children:"apiGetRequest"}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsxs(n.span,{className:"token template-string",children:[s.jsx(n.span,{className:"token template-punctuation string",children:"`"}),s.jsx(n.span,{className:"token string",children:"/credentials/"}),s.jsxs(n.span,{className:"token interpolation",children:[s.jsx(n.span,{className:"token interpolation-punctuation punctuation",children:"${"}),"app",s.jsx(n.span,{className:"token punctuation",children:"."}),"appName",s.jsx(n.span,{className:"token interpolation-punctuation punctuation",children:"}"})]}),s.jsx(n.span,{className:"token template-punctuation string",children:"`"})]}),s.jsx(n.span,{className:"token punctuation",children:","})," jwt",s.jsx(n.span,{className:"token punctuation",children:")"}),s.jsx(n.span,{className:"token punctuation",children:"."}),s.jsx(n.span,{className:"token function",children:"then"}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token punctuation",children:"("}),"response",s.jsx(n.span,{className:"token punctuation",children:")"})," ",s.jsx(n.span,{className:"token operator",children:"=>"})," ",s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["			",s.jsx(n.span,{className:"token function",children:"setCredentials"}),s.jsx(n.span,{className:"token punctuation",children:"("}),"response",s.jsx(n.span,{className:"token punctuation",children:"."}),"iamCredentials",s.jsx(n.span,{className:"token punctuation",children:")"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		",s.jsx(n.span,{className:"token punctuation",children:"}"}),s.jsx(n.span,{className:"token punctuation",children:")"}),s.jsx(n.span,{className:"token punctuation",children:"."}),s.jsx(n.span,{className:"token function",children:"catch"}),s.jsx(n.span,{className:"token punctuation",children:"("}),"setProblem",s.jsx(n.span,{className:"token punctuation",children:")"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token punctuation",children:"}"}),s.jsx(n.span,{className:"token punctuation",children:","})," ",s.jsx(n.span,{className:"token punctuation",children:"["}),"app",s.jsx(n.span,{className:"token punctuation",children:"]"}),s.jsx(n.span,{className:"token punctuation",children:")"}),`
`]})]})}),`
`,s.jsx(n.p,{children:"Then use these credentials to create a AWS S3 SDK session on our client"}),`
`,s.jsx(n.pre,{className:"language-ts",children:s.jsxs(n.code,{className:"language-ts code-highlight",children:[s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token function",children:"useEffect"}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token punctuation",children:")"})," ",s.jsx(n.span,{className:"token operator",children:"=>"})," ",s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		",s.jsx(n.span,{className:"token keyword",children:"if"})," ",s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token operator",children:"!"}),"credentials",s.jsx(n.span,{className:"token punctuation",children:")"})," ",s.jsx(n.span,{className:"token keyword",children:"return"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		",s.jsx(n.span,{className:"token keyword",children:"async"})," ",s.jsx(n.span,{className:"token keyword",children:"function"})," ",s.jsx(n.span,{className:"token function",children:"createS3Client"}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token punctuation",children:")"})," ",s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["			",s.jsx(n.span,{className:"token keyword",children:"const"})," s3 ",s.jsx(n.span,{className:"token operator",children:"="})," ",s.jsx(n.span,{className:"token keyword",children:"new"})," ",s.jsx(n.span,{className:"token class-name",children:"S3Client"}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["				region",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token constant",children:"AWS_REGION"}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["				credentials",s.jsx(n.span,{className:"token operator",children:":"})," ",s.jsx(n.span,{className:"token punctuation",children:"{"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["					accessKeyId",s.jsx(n.span,{className:"token operator",children:":"})," credentials",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:"."}),"Credentials",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:"."}),"AccessKeyId",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["					secretAccessKey",s.jsx(n.span,{className:"token operator",children:":"})," credentials",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:"."}),"Credentials",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:"."}),"SecretAccessKey",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["					sessionToken",s.jsx(n.span,{className:"token operator",children:":"})," credentials",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:"."}),"Credentials",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:"."}),"SessionToken",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["					expiration",s.jsx(n.span,{className:"token operator",children:":"})," credentials",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:"."}),"Credentials",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:"."}),"Expiration",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:","}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["					accountId",s.jsx(n.span,{className:"token operator",children:":"})," credentials",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:"."}),"AssumedRoleUser",s.jsx(n.span,{className:"token operator",children:"!"}),s.jsx(n.span,{className:"token punctuation",children:"."}),"AssumedRoleId",s.jsx(n.span,{className:"token operator",children:"!"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["				",s.jsx(n.span,{className:"token punctuation",children:"}"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["			",s.jsx(n.span,{className:"token punctuation",children:"}"}),s.jsx(n.span,{className:"token punctuation",children:")"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["			",s.jsx(n.span,{className:"token function",children:"setS3Client"}),s.jsx(n.span,{className:"token punctuation",children:"("}),"s3",s.jsx(n.span,{className:"token punctuation",children:")"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		",s.jsx(n.span,{className:"token punctuation",children:"}"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["		",s.jsx(n.span,{className:"token function",children:"createS3Client"}),s.jsx(n.span,{className:"token punctuation",children:"("}),s.jsx(n.span,{className:"token punctuation",children:")"}),`
`]}),s.jsxs(n.span,{className:"code-line",children:["	",s.jsx(n.span,{className:"token punctuation",children:"}"}),s.jsx(n.span,{className:"token punctuation",children:","})," ",s.jsx(n.span,{className:"token punctuation",children:"["}),"credentials",s.jsx(n.span,{className:"token punctuation",children:"]"}),s.jsx(n.span,{className:"token punctuation",children:")"}),`
`]})]})}),`
`,s.jsx(n.p,{children:"Now we can use the s3 client to access only resources under our specified prefix!"})]})}function t(e={}){const{wrapper:n}=e.components||{};return n?s.jsx(n,{...e,children:s.jsx(a,{...e})}):a(e)}export{t as default};
